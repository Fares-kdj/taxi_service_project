RewriteEngine On

# Sitemap
RewriteRule ^sitemap\.xml$ sitemap.php [L]

# 1. Hide .php extension
# To externally redirect /file.php to /file
RewriteCond %{THE_REQUEST} ^[A-Z]{3,}\s([^.]+)\.php [NC]
RewriteCond %{REQUEST_METHOD} !POST
RewriteRule ^ %1 [R=301,L]

# To internally forward /file to /file.php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteRule ^(.*?)/?$ $1.php [L]

# 2. Change /admin to /monespace
# Internally rewrite requests for /monespace to /admin
RewriteRule ^monespace/(.*)$ admin/$1 [L,QSA]
RewriteRule ^monespace$ admin/ [L,QSA]

# Optional: Prevent direct access to /admin (uncomment to enforce)
# RewriteCond %{THE_REQUEST} \s/admin [NC]
# RewriteRule ^admin/(.*)$ /monespace/$1 [R=301,L]

# 3. Allow clean URLs for nested directories (like monespace/bookings)
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^monespace/([^/]+)/?$ admin/$1.php [L,QSA]
